# 2026-02-25 Memory Daily

- 来源：用户需求（外部知识源提取 + 自动识别同步）
- 生成时间：2026-02-25 11:49

## Meta
- 项目名：Agent Engineer 记忆抽取增强
- 阶段：v2.1 外部源原子化
- 目标：把外部日志沉淀为可复用原子关系，并实现自动增量识别

## Actions
- 新增外部抽取脚本 `pipeline/ingest_external_atomic.py`，按最近 90 天扫描两类外部源。
- 新增统一入口 `pipeline/run_memory_sync.sh` + `pipeline/auto_memory_sync.py`，自动判断是否需要重跑 daily/external ingest。
- 新增外部入口 `pipeline/run_external_ingest.sh`，支持 `--days` 与 `--force`。
- 新增原子关系区 `memory/areas/profile/subject-object-actions/`。
- 更新 `README.md`、`pipeline/workflow.md`、`AGENTS.md`、`memory/INDEX.md`。
- 更新 `pipeline/build_weekly_context.py`，周聚合从硬编码改为自动读取全部 `memory/areas/**/summary.md`。
- 修复外部抽取“自我回灌”问题：排除当前工作区目录，避免循环增生。

## Evidence
- 命令验证：`bash pipeline/run_external_ingest.sh --days 90 --force`
- 结果输出：扫描 42 文件，解析 413 条关系，写入 `memory/areas/profile/subject-object-actions/items.json`
- 增量验证：`bash pipeline/run_memory_sync.sh` 第二次执行显示 daily/external 均按状态跳过
- 周聚合验证：`bash pipeline/run_weekly_review.sh 7` 成功，且周包含 `memory/areas/profile/subject-object-actions/summary.md`

## Decisions
- 问题：外部源规模大且噪音高，手工抽取不可持续。
- 根因：缺少“范围约束 + 增量状态 + 统一入口”机制。
- 决策：采用“90 天窗口 + 指定文档类型 + 状态指纹 + 自动判断是否重跑”。
- 是否替代旧结论（是/否）：否
- 若是，旧结论ID：

## Topics
- 写作工作区的外部知识源应该如何做增量提取
- 原子化关系模型：主体 -> 客体 -> 动作
- 自动识别同步如何降低遗漏和重复劳动
- 周输入包自动覆盖新增记忆 area

## Formulas
- 原子提取结构：主体 -> 客体 -> 动作 -> 证据 -> 来源 -> 置信度
- 协作入口：统一执行 `run_memory_sync.sh`，由脚本决定是否重跑
- 防回灌策略：外部源扫描排除当前工作区目录

## Channels
- 公众号：可把“自动化沉淀体系”写成方法论长文
- 抖音：可拆成“1 个命令自动同步记忆”的短操作脚本

## Conclusions
- 结论：写作工作区要稳定复利，外部知识源提取必须使用增量状态判断，不能每次全量重刷。
  - 证据：`ingest_external_atomic.py` 以指纹判断改动，重复执行可跳过。
  - 置信度：0.94
- 结论：统一入口脚本比人工判断更可靠，能减少“忘记沉淀”导致的内容断层。
  - 证据：`run_memory_sync.sh` 已联动 daily/external 两类沉淀并通过命令验证。
  - 置信度：0.91

## Update（v2.2 极简化）
- 触发：用户明确要求“高质量、可复利、精简高效”，并将外部原子字段压缩为 `date/fact/source/tags`。
- 动作：重写 `pipeline/ingest_external_atomic.py` 为高价值胶囊模式，删除冗余字段与细胞级记录。
- 规则：每文件最多 2 条，总量最多 60 条；仅保留“洞察/里程碑/失败复盘/奇思妙想”。
- 验证：`bash pipeline/run_external_ingest.sh --days 90 --force` 输出 `49` 条（由 400+ 条进一步压缩）。
- 结论：外部记忆层不追求全记录，默认只保留“可直接复用到创作”的高价值胶囊。
