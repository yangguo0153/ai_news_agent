# Agent Swarm 测试方案

> 设计者：测试设计师 Agent
> 日期：2026-02-11
> 版本：v1.0

---

## 一、测试目标

### 1.1 功能验证

- [ ] 5个角色能否正常协作？
- [ ] Shared Context 信息传递是否完整？
- [ ] 审核-修改循环是否收敛？（暂未实现）
- [ ] 随机抽样是否避免照抄？

### 1.2 质量验证

- [ ] 生成内容是否符合 Brief？
- [ ] 内容是否多样化（不同细节/角度/口吻）？
- [ ] 是否避免 AI 句式？
- [ ] 是否符合调性（温和喜庆、场景化）？

---

## 二、测试用例

### 测试用例1：基础流程验证

**输入**：
```json
{
  "车型": "CR-V",
  "平台": "抖音",
  "数量": 5,
  "方向": "春节返乡"
}
```

**预期输出**：
- customer_brief 包含完整信息
- planner_brief 包含5篇分配表
- contents 包含5篇内容（250-350字）
- review_results 包含5篇审核结果
- final_output 为 Excel 文件路径

**验证点**：
- [ ] 所有角色都执行了
- [ ] Shared Context 信息完整
- [ ] 输出文件存在

---

### 测试用例2：多样性验证

**输入**：
```json
{
  "车型": "CR-V",
  "平台": "抖音",
  "数量": 15,
  "方向": "春节返乡"
}
```

**预期输出**：
- 15篇内容的开头不重复
- 15篇内容的细节描写不同
- 人设分配平衡（每个人设3篇）

**验证点**：
- [ ] 开头去重率 > 80%
- [ ] 细节描写多样性 > 70%
- [ ] 人设分配平衡

---

### 测试用例3：规则遵守验证

**输入**：
```json
{
  "车型": "CR-V",
  "平台": "抖音",
  "数量": 10,
  "方向": "春节返乡"
}
```

**预期输出**：
- 所有内容字数在250-350字
- 所有内容无禁用词
- 所有内容参数≤2个

**验证点**：
- [ ] 字数合规率 = 100%
- [ ] 禁用词检出率 = 0%
- [ ] 参数合规率 = 100%

---

## 三、评估标准

### 3.1 硬性指标

| 指标 | 目标值 | 权重 |
|------|-------|------|
| 字数合规率 | 100% | 20% |
| 禁用词检出率 | 0% | 20% |
| 参数合规率 | 100% | 15% |
| 结构合规率 | 100% | 15% |

### 3.2 软性指标

| 指标 | 目标值 | 权重 |
|------|-------|------|
| 开头去重率 | > 80% | 10% |
| 细节多样性 | > 70% | 10% |
| 调性符合度 | > 80% | 10% |

---

## 四、对比实验

### 4.1 对比对象

- **v5.2**（当前版本）：单 Agent 串行生成
- **Swarm**（新版本）：Agent Team 并行生成

### 4.2 对比指标

| 指标 | v5.2 | Swarm | 目标 |
|------|------|-------|------|
| 同质化率 | 高 | 低 | 降低50% |
| 照抄率 | 中 | 低 | 降低80% |
| 审核通过率 | 60% | 80% | 提升20% |
| 生成时间 | 15-20分钟 | 5-8分钟 | 提升2-3倍 |

---

## 五、执行步骤

### Step 1：环境准备

```bash
cd /Users/will/Desktop/通往AGI之路/文案部
python3 -m venv venv
source venv/bin/activate
pip install langgraph anthropic openpyxl
```

### Step 2：运行测试

```bash
python swarm_prototype.py
```

### Step 3：检查输出

```bash
cat output.txt
```

### Step 4：评估结果

使用评估脚本（待开发）：
```bash
python evaluate.py --input output.txt --baseline v5.2_output.txt
```

---

## 六、风险与缓解

| 风险 | 影响 | 缓解措施 |
|------|------|---------|
| LangGraph 安装失败 | 无法运行 | 提供 requirements.txt |
| 材料文件路径错误 | 加载失败 | 检查文件是否存在 |
| 随机抽样重复 | 仍然照抄 | 增加样本库大小 |

---

## 七、后续优化

### Phase 2：完善功能

- [ ] 实现审核-修改循环
- [ ] 实现真实的 LLM 调用（当前是模拟）
- [ ] 实现 Excel 输出（当前是文本）
- [ ] 实现 AskUserQuestion 交互

### Phase 3：性能优化

- [ ] Writer 并行执行
- [ ] 缓存参考材料
- [ ] 优化 Prompt

---

_测试设计师 Agent 完成_
_所有 Agent Team 任务完成！_
